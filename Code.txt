You're stuck in a **half-installed state** where:

* ✅ Node.js 18 is correctly installed from **Nodesource**
* ❌ `npm` is broken because it's trying to reinstall from the **Ubuntu/Debian package registry**, which is missing dependencies — *because you're mixing package sources (Nodesource + Debian default)*

---

## ✅ Solution: Get `npm` the right way (via NodeSource)

Since `nodejs` from NodeSource **includes npm**, we’ll manually symlink or reinstall npm without touching broken `apt` dependencies.

---

## 🔧 FIX: Manual Symlink or Clean NPM Reinstall

### 🔹 **Option 1: Symlink npm manually** (quickest, try first)

Run:

```bash
sudo ln -s /usr/bin/npm /opt/nodejs/bin/npm
```

Then:

```bash
npm -v
```

If this works — you're done.

---

### 🔹 **Option 2: Remove Debian npm, reinstall npm from official source**

1. **Purge broken npm packages**:

```bash
sudo apt remove npm -y
sudo apt autoremove -y
```

2. **Install npm cleanly using NodeSource version**:

```bash
sudo npm install -g npm
```

Then confirm:

```bash
which npm
npm -v
```

---

## 🧼 BONUS: Fix `.bashrc` or `.profile` Path Pollution

If you're still getting `/opt/nodejs/bin/npm` errors even after reinstall:

Run:

```bash
nano ~/.bashrc
```

Look for:

```bash
export PATH=/opt/nodejs/bin:$PATH
```

Delete that line. Then:

```bash
source ~/.bashrc
hash -r
```

---

## ✅ Final Check

```bash
node -v       # should be v18.20.8
npm -v        # should be something like 10.x or higher
which node    # should show /usr/bin/node
which npm     # should show /usr/bin/npm
```

---

Let me know if you're still getting that `/opt/nodejs/bin/npm` error. This is common after people install Node manually once in `/opt` and later switch to NodeSource.
